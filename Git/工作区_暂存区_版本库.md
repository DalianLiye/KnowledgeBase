# 基本概念
- **工作区**\
工作区是本地计算机上的项目目录，在这里进行文件的创建、修改和删除操作\
工作区包含了当前项目的所有文件和子目录\
文件的修改在工作区中进行，但这些修改还没有被记录到版本控制中

- **暂存区**\
暂存区是一个临时区域，用于存放即将提交的更改\
用户可以将文件的快照添加到暂存区，以便在下一次提交时包含这些更改\
一般存放在.git目录下的index文件（.git/index）中，所以把暂存区有时也叫作索引（index）\
这个文件包含了所有已暂存文件的状态、路径和指向相应Git对象的引用

- **版本库**\
版本库是Git管理所有版本历史和数据的地方\
位于工作区的一个隐藏目录.git，它不属于工作区\
它包含了所有提交的历史记录、Git对象、分支、标签等信息

- **注**\
暂存区和版本库是两个概念，它们都处于.git文件夹内\
虽然整个.git文件夹可以被称为版本库，且暂存区位于里面的index文件（.git/index）里，但不能说版本库包含了暂存区


# .git文件夹
   - **.git/objects/**
     - **作用：** 存储Git的所有对象，包含 Blob、Tree、Commit和Tag等
     - **结构：** 在这个目录中，所有对象以其SHA-1哈希值的前两位作为子目录名，后面的哈希值作为文件名存储\
	             例如，哈希值为 abc123... 的对象会存储在 .git/objects/ab/c123...
     - **各个对象：**
		 - **Blob（Binary Large Object）：** 存储文件内容的对象
		 - **Tree：** 存储目录结构的对象，记录了文件名、类型和指向 Blob 对象的引用
		 - **Commit：** 存储提交信息的对象，包括指向 Tree 对象的引用以及父提交的引用等
		 - **Tag：** 存储特定提交的标签信息

   - **.git/refs/**
	 - **作用：** 存储指向对象的引用, 包含分支、标签等的引用
	 - **结构：**
		- **refs/heads/：** 存储分支的引用（例如 refs/heads/master）
		- **refs/tags/：** 存储标签的引用（例如 refs/tags/v1.0）
		- **refs/remotes/：** 存储远程分支的引用

   - **.git/HEAD**
     - **作用：** 指向当前检出分支的引用, 通常是refs/heads/<branch-name>
     - **结构：** 文件内容指向一个引用，表示当前分支的状态
	 
   - **.git/config**
     - **作用：** 存储本地仓库的配置选项
     - **内容：** 包括用户信息（如名称和电子邮件）、远程仓库的URL、合并和拉取策略等设置
	 
   - **.git/description**
     - **作用：** 为Git仓库提供描述信息，主要在Git仓库作为服务时使用
     - **内容：** 通常在GitWeb等工具中显示
	 
   - **.git/index**
     - **作用：** 也称为暂存区（Staging Area），保存即将提交的文件状态
     - **内容：** 记录了文件路径、文件模式、指向相应Blob对象的引用等信息
	 
   - **.git/logs/**
	 - **作用：** 记录引用（如分支和 HEAD）的变动历史
	 - **结构：**
		- **logs/HEAD：** 记录了 HEAD 的变动历史，显示何时切换分支、提交等
		- **logs/refs/heads/<branch-name>：** 记录特定分支的变动历史
	 
   - **.git/hooks/**
	 - **作用：** 用于存放钩子脚本，这些脚本可以在特定事件发生时触发（如提交、合并等）
	 - **内容：** 默认提供了一些示例脚本（如 pre-commit、post-commit），可根据需要启用并自定义
	 
   - **.git/packed-refs**
	 - **作用：** 优化存储引用的方式，以避免大量小文件的管理
	 - **内容：** 将多个引用（如分支和标签）打包存储为单个文件，提高性能
	 
   - **.git/info**
	 - **作用：** 存储一些额外的信息
	 - **结构：** 
		- **info/exclude：** 用于存放不被Git跟踪的文件模式，类似于.gitignore，但仅限于本地使用
	 
 

# 文件创建提交后台流程
- **git init**
   创建本地仓库，创建一个新的.git文件夹，文件夹包含Git仓库的所有元数据和版本控制信息
   
- **create file**
   创建一个名为 README.md 的文件, 此时README.md文件被创建并包含了内容\
   这个文件现在处于工作区中，但尚未被Git跟踪
   
- **git add <file>**
   Git会依次进行以下处理：
   
   - **确认工作目录状态**\
     Git首先会确认指定的文件是否存在于工作目录中\
	 如果文件不存在，Git会返回一个错误消息
   
   - **检查文件状态**\
     Git会检查指定文件的状态，确定是新文件、还是已修改文件

   - **计算文件的SHA-1哈希值**\
     Git会读取文件内容，并计算其SHA-1哈希值\
	 SHA-1是一种加密散列函数，用于生成一个唯一的哈希值，代表文件的内容
   
   - **创建Blob对象**\
     Git创建一个Blob对象来存储文件的内容\
	 Blob对象包括：
		- **内容：** 文件的实际内容
		- **SHA-1哈希值：** 就是上一步生成的哈希值，用来唯一标识这个Blob对象的哈希值
		
   - **保存Blob对象**\
     保存路径结构：.git/objects/<first_two_chars_of_hash>/<remaining_hash>\
	 比如，哈希值是a1b2c3d4e5f6g7h8i9j0，那么它会存储在 .git/objects/a1/b2c3d4e5f6g7h8i9j0
   
   - **更新暂存区（Index）**\
     Git将Blob对象的引用添加到暂存区（也称为 Index）\
	 暂存区是一个临时存储区，保存了即将被提交的文件状态\
	 在这一过程中，Git会执行以下操作：
	   - 如果文件是新文件，Git会在暂存区中创建一个新的条目，指向新创建的Blob对象\
	   - 如果文件是已跟踪文件，Git会更新暂存区中的现有条目，以指向更新后的Blob对象
   
   - **更新文件的元数据**\
     Git在暂存区中保存关于文件的元数据，例如：
       - 文件路径
       - 文件模式（如普通文件或可执行文件）
       - 指向Blob对象的引用（SHA-1哈希值）
       - 对于已跟踪文件，Git会记录文件的状态为"已修改"
   
   - **刷新工作区状态**\
     git add命令完成后，Git会将工作区中的文件状态在暂存区中更新为已暂存\
	 可以使用git status命令查看当前的文件状态，会显示那些已暂存待提交的文件
   
   - **处理路径名分隔符和其他特性**\
     Git还会处理路径名分隔符（如 Windows 和 Unix 系统）及其他具体情况（如符号链接、文件权限等），以确保在不同操作系统上保持一致的行为
   

- **git commit**

  Git会依次进行以下处理：
   
   - **确认暂存区状态**\
     Git首先会检查暂存区（即索引）是否有待提交的更改\
	 如果暂存区为空（没有已暂存的文件），Git会返回错误消息，指示没有文件需要提交

   - **创建提交对象**\
     Git将开始创建一个新的提交对象\
	 这个对象包括了很多信息，比如指向文件内容的快照、作者信息、提交信息等\
     同时，Git会为新的提交对象计算一个SHA-1哈希值，以确保该对象的唯一性

   - **处理暂存区内容**\
     Git从暂存区读取所有文件的状态，包括每个文件指向的Blob对象的哈希值\
     Git会将这些哈希值封装进新的提交对象中，以形成文件的快照

   - **生成提交信息**\
     Git会使用提供的提交消息（通过 -m 选项或在文本编辑器中输入）来创建提交对象中的提交信息部分\
	 这部分会记录谁进行了此次提交与何时进行的

   - **记录作者和提交者信息**\
     Git会将作者的信息（名称和电子邮件）以及提交的时间戳记录在提交对象中\
	 这些信息会被存储为提交对象的一部分
	 
   - **记录父提交信息**\
     如果有先前的提交（非初始提交），Git会记录指向父提交的引用\
	 这样，Git能够形成一个提交历史链表\
	 对于第一次提交，父提交指向一个空值
	 
   - **存储提交对象**\
     将生成的提交对象存储在.git/objects目录中\
	 提交对象的路径结构为.git/objects/<first_two_chars_of_hash>/<remaining_hash>

   - **更新引用**\
     Git会更新当前分支引用（如 refs/heads/<当前branch name>）以指向新的提交对象\
	 这使得HEAD始终指向最新的提交\
     对于没有分支的情况（如在分离头指针状态下），Git也会记住当前的提交
	 
   - **清空暂存区**\
     提交完成后，Git会清空暂存区的状态\
	 所有已暂存的文件的状态会被重置，以便为下次提交做好准备

   - **提交后的文件状态**\
     Git会在暂存区index文件中更新工作区文件的状态，确保它们反映提交后的状态\
	 如果文件在提交之后被修改并追踪，状态会被更新为“已修改”，准备下一次操作

   - **输出提交结果**\
     Git会在命令行输出提交结果，包括新提交的哈希值、提交信息、作者等信息\
	 如果是成功的提交，Git会显示一条包含这些信息的消息
